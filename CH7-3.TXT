SQL> 
SQL> REM DISPLAY THOSE WHO REPORTS TO ANY DEPARTMENT HEAD (16 ROWS)
SQL> 
SQL> SET LINES 200 PAGES 24
SQL> 
SQL> SELECT DEPARTMENT_ID FROM DEPARTMENTS;

DEPARTMENT_ID                                                                                                                                                                                           
-------------                                                                                                                                                                                           
           10                                                                                                                                                                                           
           20                                                                                                                                                                                           
           50                                                                                                                                                                                           
           60                                                                                                                                                                                           
           80                                                                                                                                                                                           
           90                                                                                                                                                                                           
          110                                                                                                                                                                                           
          190                                                                                                                                                                                           

8 rows selected.

SQL> SELECT MANAGER_ID FROM DEPARTMENTS;

MANAGER_ID                                                                                                                                                                                              
----------                                                                                                                                                                                              
       200                                                                                                                                                                                              
       201                                                                                                                                                                                              
       124                                                                                                                                                                                              
       103                                                                                                                                                                                              
       149                                                                                                                                                                                              
       100                                                                                                                                                                                              
       205                                                                                                                                                                                              
                                                                                                                                                                                                        

8 rows selected.

SQL> SELECT FIRST_NAME , MANAGER_ID
  2  FROM EMPLOYEES
  3  WHERE MANAGER_ID IN (SELECT MANAGER_ID FROM DEPARTMENTS);

FIRST_NAME MANAGER_ID                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
Pat               201                                                                                                                                                                                   
Trenna            124                                                                                                                                                                                   
Curtis            124                                                                                                                                                                                   
Randall           124                                                                                                                                                                                   
Peter             124                                                                                                                                                                                   
Bruce             103                                                                                                                                                                                   
Diana             103                                                                                                                                                                                   
Ellen             149                                                                                                                                                                                   
Jonathon          149                                                                                                                                                                                   
Kimerely          149                                                                                                                                                                                   
Neena             100                                                                                                                                                                                   
Lex               100                                                                                                                                                                                   
Kevin             100                                                                                                                                                                                   
Eleni             100                                                                                                                                                                                   
Michael           100                                                                                                                                                                                   
William           205                                                                                                                                                                                   

16 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , MANAGER_ID
  2  FROM EMPLOYEES
  3  WHERE (DEPARTMENT_ID , MANAGER_ID) IN (SELECT DEPARTMENT_ID , MANAGER_ID FROM DEPARTMENTS);      // JODDD BEY!!!!!!

FIRST_NAME DEPARTMENT_ID MANAGER_ID                                                                                                                                                                     
---------- ------------- ----------                                                                                                                                                                     
Neena                 90        100                                                                                                                                                                     
Lex                   90        100                                                                                                                                                                     
Bruce                 60        103                                                                                                                                                                     
Diana                 60        103                                                                                                                                                                     
Trenna                50        124                                                                                                                                                                     
Curtis                50        124                                                                                                                                                                     
Randall               50        124                                                                                                                                                                     
Peter                 50        124                                                                                                                                                                     
Ellen                 80        149                                                                                                                                                                     
Jonathon              80        149                                                                                                                                                                     
Pat                   20        201                                                                                                                                                                     
William              110        205                                                                                                                                                                     

12 rows selected.

SQL> REM TO DISPLAY THOSE WHO DOES'NT REPORT TO ANY DEPARTMENT HEAD ////// DONE BY ME!!!!

SQL> SELECT MANAGER_ID,DEPARTMENT_ID FROM EMPLOYEES WHERE (DEPARTMENT_ID,MANAGER_ID) NOT IN (SELECT DEPARTMENT_ID,MANAGER_ID FROM DEPARTMENTS);

     MANAGER_ID	DEPARTMENT_ID
    ----------- ---------------
     102	           60

     100	           50

     100	           80

     101	           10

     100	           20

     101	           110

6 rows selected.

SQL> 

SQL> REM 21 DISPLAY ALL WHO GETS SALARY IN GRADE_LEVEL D.//DOUBT
SQL> 
SQL> SELECT FIRST_NAME FROM EMPLOYEES WHERE SALARY BETWEEN ((SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL=D) AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL=D));
SELECT FIRST_NAME FROM EMPLOYEES WHERE SALARY BETWEEN ((SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL=D) AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL=D))
                                                                                                               *
ERROR at line 1:
ORA-00907: missing right parenthesis 


SQL> SELECT FIRST_NAME FROM EMPLOYEES WHERE SALARY BETWEEN ((SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D') AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D'));
SELECT FIRST_NAME FROM EMPLOYEES WHERE SALARY BETWEEN ((SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D') AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D'))
                                                                                                                 *
ERROR at line 1:
ORA-00907: missing right parenthesis 


SQL> SELECT FIRST_NAME FROM EMPLOYEES WHERE SALARY BETWEEN (SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D') AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D');

FIRST_NAME                                                                                                                                                                                              
----------                                                                                                                                                                                              
Eleni                                                                                                                                                                                                   
Ellen                                                                                                                                                                                                   
Michael                                                                                                                                                                                                 
Shelley                                                                                                                                                                                                 

SQL> SELECT FIRST_NAME , SALARY FROM EMPLOYEES WHERE SALARY BETWEEN (SELECT LOWEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D') AND (SELECT HIGHEST_SAL FROM JOB_GRADES WHERE GRADE_LEVEL='D');

SQL> CAN BE DONE THROUGH JOIN ALSO  // VIRAL MODI

SQL> SELECT FIRST_NAME,GRADE_LEVEL FROM EMPLOYEES
     JOIN JOB_GRADES ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL WHERE GRADE_LEVEL = 'D';         // OP!!

FIRST_NAME     SALARY                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
Eleni           10500                                                                                                                                                                                   
Ellen           11000                                                                                                                                                                                   
Michael         13000                                                                                                                                                                                   
Shelley         12000                                                                                                                                                                                   

SQL> REM DISPLAY ALL WHO GETS HIGHEST SALARY FOR THEIR GRADE_LEVEL.      // OP QUESTION!!!!!
SQL> 
SQL> SELECT FIRST_NAME , SALARY , GRADE_LEVEL
  2  FROM EMPLOYEES
  3  JOIN JOB_GRADES ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  4  WHERE SALARY IN
  5  
SQL> 
SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME LAST_NAME  EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                               
----------- ---------- ---------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                               
        100 Steven     King       SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                               
        101 Neena      Kochhar    NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                               
        102 Lex        De Haan    LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                               
        103 Alexander  Hunold     AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                               
        104 Bruce      Ernst      BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                               
        107 Diana      Lorentz    DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                               
        124 Kevin      Mourgos    KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                               
        141 Trenna     Rajs       TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                               
        142 Curtis     Davies     CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                               
        143 Randall    Matos      RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                               
        144 Peter      Vargas     PVARGAS    650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                               
        149 Eleni      Zlotkey    EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                               
        174 Ellen      Abel       EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                               
        176 Jonathon   Taylor     JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                               
        178 Kimerely   Grant      KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                             
        200 Jennifer   Whalen     JWAHLEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                               
        201 Michael    Hartstein  MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                               
        202 Pat        Fay        PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                               
        205 Shelley    Higgins    SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                               
        206 William    Gietz      WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                               

20 rows selected.

SQL> SELECT * FROM JOB_GRADES;

GRA LOWEST_SAL HIGHEST_SAL                                                                                                                                                                              
--- ---------- -----------                                                                                                                                                                              
A         1000        2999                                                                                                                                                                              
B         3000        5999                                                                                                                                                                              
C         6000        9999                                                                                                                                                                              
D        10000       14999                                                                                                                                                                              
E        15000       24999                                                                                                                                                                              
F        25000       40000                                                                                                                                                                              

6 rows selected.

SQL> SELECT * FROM EMPLOYEES ORDER BY SALARY;

EMPLOYEE_ID FIRST_NAME LAST_NAME  EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                               
----------- ---------- ---------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                               
        144 Peter      Vargas     PVARGAS    650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                               
        143 Randall    Matos      RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                               
        142 Curtis     Davies     CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                               
        141 Trenna     Rajs       TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                               
        107 Diana      Lorentz    DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                               
        200 Jennifer   Whalen     JWAHLEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                               
        124 Kevin      Mourgos    KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                               
        104 Bruce      Ernst      BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                               
        202 Pat        Fay        PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                               
        178 Kimerely   Grant      KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                             
        206 William    Gietz      WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                               
        176 Jonathon   Taylor     JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                               
        103 Alexander  Hunold     AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                               
        149 Eleni      Zlotkey    EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                               
        174 Ellen      Abel       EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                               
        205 Shelley    Higgins    SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                               
        201 Michael    Hartstein  MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                               
        101 Neena      Kochhar    NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                               
        102 Lex        De Haan    LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                               
        100 Steven     King       SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                               

20 rows selected.

SQL> SELECT FIRST_NAME , SALARY , GRADE_LEVEL
  2  FROM EMPLOYEES
  3  JOIN JOB_GRADES ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  4  ;

FIRST_NAME     SALARY GRA                                                                                                                                                                               
---------- ---------- ---                                                                                                                                                                               
Peter            2500 A                                                                                                                                                                                 
Randall          2600 A                                                                                                                                                                                 
Curtis           3100 B                                                                                                                                                                                 
Trenna           3500 B                                                                                                                                                                                 
Diana            4200 B                                                                                                                                                                                 
Jennifer         4400 B                                                                                                                                                                                 
Kevin            5800 B                                                                                                                                                                                 
Bruce            6000 C                                                                                                                                                                                 
Pat              6000 C                                                                                                                                                                                 
Kimerely         7000 C                                                                                                                                                                                 
William          8300 C                                                                                                                                                                                 
Jonathon         8600 C                                                                                                                                                                                 
Alexander        9000 C                                                                                                                                                                                 
Eleni           10500 D                                                                                                                                                                                 
Ellen           11000 D                                                                                                                                                                                 
Shelley         12000 D                                                                                                                                                                                 
Michael         13000 D                                                                                                                                                                                 
Neena           17000 E                                                                                                                                                                                 
Lex             17000 E                                                                                                                                                                                 
Steven          24000 E                                                                                                                                                                                 

20 rows selected.
 
SQL> SELECT FIRST_NAME , SALARY , GRADE_LEVEL                             // MOST OP!!!!! LOGIC IS TOO MUCH!!!!!!
  2  FROM EMPLOYEES
  3  JOIN JOB_GRADES ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  4  WHERE (GRADE_LEVEL , SALARY) IN (SELECT GRADE_LEVEL , MAX(SALARY) FROM EMPLOYEES JOIN JOB_GRADES
  5                                   ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  6                                   GROUP BY GRADE_LEVEL);

FIRST_NAME     SALARY GRA                                                                                                                                                                               
---------- ---------- ---                                                                                                                                                                               
Steven          24000 E                                                                                                                                                                                 
Alexander        9000 C                                                                                                                                                                                 
Kevin            5800 B                                                                                                                                                                                 
Randall          2600 A                                                                                                                                                                                 
Michael         13000 D                                                                                                                                                                                 

SQL> SELECT FIRST_NAME , SALARY , GRADE_LEVEL
  2  FROM EMPLOYEES
  3  JOIN JOB_GRADES ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  4  WHERE (GRADE_LEVEL , SALARY) IN (SELECT GRADE_LEVEL , MAX(SALARY) FROM EMPLOYEES JOIN JOB_GRADES
  5                                   ON SALARY BETWEEN LOWEST_SAL AND HIGHEST_SAL
  6                                   GROUP BY GRADE_LEVEL)
  7  ORDER BY 3;

FIRST_NAME     SALARY GRA                                                                                                                                                                               
---------- ---------- ---                                                                                                                                                                               
Randall          2600 A                                                                                                                                                                                 
Kevin            5800 B                                                                                                                                                                                 
Alexander        9000 C                                                                                                                                                                                 
Michael         13000 D                                                                                                                                                                                 
Steven          24000 E                                                                                                                                                                                 

SQL> SELECT * FROM JOB_GRADES;

GRA LOWEST_SAL HIGHEST_SAL                                                                                                                                                                              
--- ---------- -----------                                                                                                                                                                              
A         1000        2999                                                                                                                                                                              
B         3000        5999                                                                                                                                                                              
C         6000        9999                                                                                                                                                                              
D        10000       14999                                                                                                                                                                              
E        15000       24999                                                                                                                                                                              
F        25000       40000                                                                                                                                                                              

6 rows selected.

SQL> SELECT FIRST_NAME , SALARY FROM EMPLOYEES ORDER BY 2;

FIRST_NAME     SALARY                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
Peter            2500                                                                                                                                                                                   
Randall          2600                                                                                                                                                                                   
Curtis           3100                                                                                                                                                                                   
Trenna           3500                                                                                                                                                                                   
Diana            4200                                                                                                                                                                                   
Jennifer         4400                                                                                                                                                                                   
Kevin            5800                                                                                                                                                                                   
Bruce            6000                                                                                                                                                                                   
Pat              6000                                                                                                                                                                                   
Kimerely         7000                                                                                                                                                                                   
William          8300                                                                                                                                                                                   
Jonathon         8600                                                                                                                                                                                   
Alexander        9000                                                                                                                                                                                   
Eleni           10500                                                                                                                                                                                   
Ellen           11000                                                                                                                                                                                   
Shelley         12000                                                                                                                                                                                   
Michael         13000                                                                                                                                                                                   
Neena           17000                                                                                                                                                                                   
Lex             17000                                                                                                                                                                                   
Steven          24000                                                                                                                                                                                   

20 rows selected.

SQL> REM 3 TO COMPARE NESTED SUMMARY ITEMS IN HAVING CLAUSE
SQL> 
SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY
SQL> 
SQL> SELECT AVG(SALARY) FROM EMPLOYEES;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       8775                                                                                                                                                                                             

SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY TO EACH DEPARTMENT
SQL> 
SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
           20        9500                                                                                                                                                                               
          110       10150                                                                                                                                                                               
           50        3500                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           60        6400                                                                                                                                                                               
           10        4400                                                                                                                                                                               

8 rows selected.

SQL> REM DISPLAY AVERAGE SALARY PAID BY COMPANY FOR THE DEPARTMENT TO WHICH HIGHEST AVERAGE SALARY IS PAID    // NESTED FUNCTION
SQL> 
SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = MAX(AVG(SALARY));             // NOT POSSIBLE!!!!! BCOZ IF WE GROUP BY DEPARTMENT_ID MULTIPLE ROWS WILL COME!!!!!!
HAVING AVG(SALARY) = MAX(AVG(SALARY))
                         *
ERROR at line 2:
ORA-00935: group function is nested too deeply 


SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES);
HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES)
                                 *
ERROR at line 2:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);        // PERFECT!!!!!!!!!

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               

SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID) GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               

SQL> SELECT DEPARTMENT_ID, AVG(SALARY) FROM EMPLOYEES
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES) GROUP BY DEPARTMENT_ID;
HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES) GROUP BY DEPARTMENT_ID
                                 *
ERROR at line 2:
ORA-00978: nested group function without GROUP BY 


SQL> REM DISPLAY JOB_ID AND AVERAGE SALARY FOR THE JOB TO WHICH LOWEST AVERAGE SALARY IS BEING PAID
SQL> 
SQL> SELECT JOB_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING AVG(SALARY) = MIN(AVG(SALARY));
HAVING AVG(SALARY) = MIN(AVG(SALARY))
                         *
ERROR at line 4:
ORA-00935: group function is nested too deeply 


SQL> SELECT JOB_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING AVG(SALARY) = (SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

SQL> REM DISPLAY MANAGER_ID AND COUNT OF EMPLOYEES REPORTING TO FOR MANAGER TO WHICH HIGHEST NO. OF EMPLOYEES REPORT.
SQL> 
SQL> SELECT MANAGER_ID , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY MANAGER_ID
  4  HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID   COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
       100          5                                                                                                                                                                                   

SQL> REM DISPLAY DEPARTMENT_ID AND AVERAGE SALARY FOR THE DEPARTMENT TO WHICH EITHER LOWEST OR HIGHEST AVERAGE SALARY IS BEING PAID.
SQL> 
SQL> SELECT DEPARTMENT_ID,AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING AVG(SALARY) IN ((SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID),(SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID));

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
           50        3500                                                                                                                                                                                                                                                                                                                                                         
SQL> REM DISPLAY JOB_ID AND AVERAGE SALARY FOR ALL JOBS EXCEPT JOB TO WHICH HIGHEST AVERAGE SALARY IS PAID
SQL> 
SQL> SELECT JOB_ID,AVG(SALARY) FROM EMPLOYEES GROUP BY JOB_ID HAVING AVG(SALARY) ^= (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID)    // JODDLY DONE!!!!!!
  2  ;

JOB_ID     AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           6400                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP      8866.66667                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

11 rows selected.

SQL> SELECT JOB_ID,AVG(SALARY) FROM EMPLOYEES GROUP BY JOB_ID HAVING AVG(SALARY) ^= ALL (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID); // <> ALL IS A BETTER CHOICE

JOB_ID     AVG(SALARY)                                                                                               // BOCZ IF MORE THAN ONE HAVE SAME HIGHEST AVG SALARY THAN MULTI ROW!!!!                                                      
---------- -----------                                                                                                                                                                                  
IT_PROG           6400                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP      8866.66667                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

11 rows selected.

SQL> SELECT JOB_ID,AVG(SALARY) FROM EMPLOYEES GROUP BY JOB_ID HAVING AVG(SALARY) NOT IN (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID); // BEST IS TO USE NOT IN OP!!!!!!!!!!

JOB_ID     AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           6400                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP      8866.66667                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

11 rows selected.

SQL> REM DISPLAY MANAGER_ID AND COUNT FOR ALL EXCEPT THOSE TO WHOM EITHER LOWEST OR HIGHEST NO. OF EMPLOYEES REPORT.
SQL> 
SQL> SELECT MANAGER_ID,COUNT(*) FROM EMPLOYEES
  2  GROUP BY MANAGER_ID
  3  HAVING COUNT(*) <> (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID) OR
  4                 COUNT(*) <> (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID   COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
                    1                                                                                                                                                                                   
       100          5                                                                                                                                                                                   
       149          3                                                                                                                                                                                   
       205          1                                                                                                                                                                                   
       102          1                                                                                                                                                                                   
       201          1                                                                                                                                                                                   
       101          2                                                                                                                                                                                   
       124          4                                                                                                                                                                                   
       103          2                                                                                                                                                                                   

9 rows selected.

SQL> SELECT MANAGER_ID,COUNT(*) FROM EMPLOYEES
  2  GROUP BY MANAGER_ID
  3  HAVING COUNT(*) <> (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID) OR
  4                 COUNT(*) <> (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID   COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
                    1                                                                                                                                                                                   
       100          5                                                                                                                                                                                   
       149          3                                                                                                                                                                                   
       205          1                                                                                                                                                                                   
       102          1                                                                                                                                                                                   
       201          1                                                                                                                                                                                   
       101          2                                                                                                                                                                                   
       124          4                                                                                                                                                                                   
       103          2                                                                                                                                                                                   

9 rows selected.

SQL> SELECT MANAGER_ID,COUNT(*) FROM EMPLOYEES
  2  GROUP BY MANAGER_ID
  3  HAVING COUNT(*) <> (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID) AND
  4                 COUNT(*) <> (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID   COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
       149          3                                                                                                                                                                                   
       101          2                                                                                                                                                                                   
       124          4                                                                                                                                                                                   
       103          2                                                                                                                                                                         
SQL> AGAIN BEST IS TO USE NOT IN (OP FUNCTION)          

SQL> SELECT MANAGER_ID,COUNT(*) FROM EMPLOYEES GROUP BY MANAGER_ID HAVING COUNT(*) NOT IN ((SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID),
     (SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID));

MANAGER_ID   COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
       149          3                                                                                                                                                                                   
       101          2                                                                                                                                                                                   
       124          4                                                                                                                                                                                   
       103          2 

4 rows selected.

SQL> REM 4 SUB QUERY IS REQUIRED WHEN WE WANT TO USE RESULT OF SUB QUERY AS TABLE OF MAIN QUERY.   // INLINE VIEW BOLTE!!!!!!!!!
SQL> 
SQL> REM INLINE VIEW : WHEN WE USE SUB QUERY IN PLACE OF TABLE
SQL> 
SQL> SELECT TABLE_NAME FROM USER_TABLES ORDER BY 1;

TABLE_NAME                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------                                                                        
ATM                                                                                                                                                                                                     
B1                                                                                                                                                                                                      
B2                                                                                                                                                                                                      
B3                                                                                                                                                                                                      
BA                                                                                                                                                                                                      
BB                                                                                                                                                                                                      
BC                                                                                                                                                                                                      
C1                                                                                                                                                                                                      
C2                                                                                                                                                                                                      
C3                                                                                                                                                                                                      
CONTACTNO                                                                                                                                                                                               
COUNTRIES                                                                                                                                                                                               
DEPARTMENTS                                                                                                                                                                                             
DEPT                                                                                                                                                                                                    
E1                                                                                                                                                                                                      
E2                                                                                                                                                                                                      
E3                                                                                                                                                                                                      
EMP                                                                                                                                                                                                     
EMPL6                                                                                                                                                                                                   
EMPLOYEES                                                                                                                                                                                               
EXAM                                                                                                                                                                                                    

TABLE_NAME                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------                                                                        
FEES                                                                                                                                                                                                    
FIXED_DEPOSIT                                                                                                                                                                                           
GTT1                                                                                                                                                                                                    
GTT2                                                                                                                                                                                                    
GTT3                                                                                                                                                                                                    
GTT4                                                                                                                                                                                                    
GTT5                                                                                                                                                                                                    
INCOME                                                                                                                                                                                                  
JOBS                                                                                                                                                                                                    
JOB_GRADES                                                                                                                                                                                              
JOB_HISTORY                                                                                                                                                                                             
LOCATIONS                                                                                                                                                                                               
MANAGER                                                                                                                                                                                                 
MEET1                                                                                                                                                                                                   
MNC                                                                                                                                                                                                     
MPSCANTEACH                                                                                                                                                                                             
MPSCMST                                                                                                                                                                                                 
MPSDEPT                                                                                                                                                                                                 
MPSDTROUTRU                                                                                                                                                                                             
MPSEMP                                                                                                                                                                                                  
MPSINCR                                                                                                                                                                                                 

TABLE_NAME                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------                                                                        
MPSITMST                                                                                                                                                                                                
MPSITTRN                                                                                                                                                                                                
MPSJOBINCR                                                                                                                                                                                              
MPSLIKETBL                                                                                                                                                                                              
MPSMIXDATA                                                                                                                                                                                              
MPSNAMES                                                                                                                                                                                                
MPSPNNO                                                                                                                                                                                                 
MPSROMANNO                                                                                                                                                                                              
MPSSALGRADE                                                                                                                                                                                             
MPSSALLIMIT                                                                                                                                                                                             
MPSSCNO                                                                                                                                                                                                 
MPSSFEES                                                                                                                                                                                                
MPSSMST                                                                                                                                                                                                 
MPSSPNO                                                                                                                                                                                                 
MPSSTAFF                                                                                                                                                                                                
MPSSUBJECT                                                                                                                                                                                              
MPSTRANS                                                                                                                                                                                                
NEMP                                                                                                                                                                                                    
NEWMPSEMP                                                                                                                                                                                               
NEWSALES                                                                                                                                                                                                
NEWTAB                                                                                                                                                                                                  

TABLE_NAME                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------                                                                        
NEW_SALES_DATA                                                                                                                                                                                          
OLDMPSEMP                                                                                                                                                                                               
OLDSALES                                                                                                                                                                                                
OLDTAB                                                                                                                                                                                                  
OLD_SALES_DATA                                                                                                                                                                                          
P1                                                                                                                                                                                                      
P2                                                                                                                                                                                                      
P3                                                                                                                                                                                                      
PLAYERS                                                                                                                                                                                                 
POSNEGNO                                                                                                                                                                                                
PQR                                                                                                                                                                                                     
PRODMST                                                                                                                                                                                                 
PRODTRN                                                                                                                                                                                                 
R1                                                                                                                                                                                                      
REGIONS                                                                                                                                                                                                 
SCHOOL                                                                                                                                                                                                  
STD5A                                                                                                                                                                                                   
STOCK_MKT_TRANSACTION                                                                                                                                                                                   
STUDENT                                                                                                                                                                                                 
T10                                                                                                                                                                                                     
T11                                                                                                                                                                                                     

TABLE_NAME                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------                                                                        
T12                                                                                                                                                                                                     
T13                                                                                                                                                                                                     
T14                                                                                                                                                                                                     
T15                                                                                                                                                                                                     
T4                                                                                                                                                                                                      
T420                                                                                                                                                                                                    
T5                                                                                                                                                                                                      
T567                                                                                                                                                                                                    
T6                                                                                                                                                                                                      
T7                                                                                                                                                                                                      
T8                                                                                                                                                                                                      
T9                                                                                                                                                                                                      
TAB1                                                                                                                                                                                                    
TARAK                                                                                                                                                                                                   
TT                                                                                                                                                                                                      
TTT                                                                                                                                                                                                     
WORKER                                                                                                                                                                                                  
XYZ                                                                                                                                                                                                     
Xyz                                                                                                                                                                                                     

103 rows selected.

SQL> 
SQL> REM 4 SUB QUERY IS REQUIRED WHEN WE WANT TO USE RESULT OF SUB QUERY AS TABLE OF MAIN QUERY.
SQL> 
SQL> REM INLINE VIEW : WHEN WE USE SUB QUERY IN PLACE OF TABLE
SQL> 
SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY FROM EMPLOYEES ORDER BY 2,3 DESC;

FIRST_NAME DEPARTMENT_ID     SALARY                                                                                                                                                                     
---------- ------------- ----------                                                                                                                                                                     
Jennifer              10       4400                                                                                                                                                                     
Michael               20      13000                                                                                                                                                                     
Pat                   20       6000                                                                                                                                                                     
Kevin                 50       5800                                                                                                                                                                     
Trenna                50       3500                                                                                                                                                                     
Curtis                50       3100                                                                                                                                                                     
Randall               50       2600                                                                                                                                                                     
Peter                 50       2500                                                                                                                                                                     
Alexander             60       9000                                                                                                                                                                     
Bruce                 60       6000                                                                                                                                                                     
Diana                 60       4200                                                                                                                                                                     
Ellen                 80      11000                                                                                                                                                                     
Eleni                 80      10500                                                                                                                                                                     
Jonathon              80       8600                                                                                                                                                                     
Steven                90      24000                                                                                                                                                                     
Lex                   90      17000                                                                                                                                                                     
Neena                 90      17000                                                                                                                                                                     
Shelley              110      12000                                                                                                                                                                     
William              110       8300                                                                                                                                                                     
Kimerely                       7000                                                                                                                                                                     

20 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY FIRST_NAME , DEPARTMENT_ID , SALARY;

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Curtis                50       3100        3100                                                                                                                                                         
Randall               50       2600        2600                                                                                                                                                         
Eleni                 80      10500       10500                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Lex                   90      17000       17000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Pat                   20       6000        6000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300        8300                                                                                                                                                         
Neena                 90      17000       17000                                                                                                                                                         
Peter                 50       2500        2500                                                                                                                                                         
Bruce                 60       6000        6000                                                                                                                                                         
Jonathon              80       8600        8600                                                                                                                                                         
Kimerely                       7000        7000                                                                                                                                                         
Diana                 60       4200        4200                                                                                                                                                         
Trenna                50       3500        3500                                                                                                                                                         

20 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID MAX(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90       24000                                                                                                                                                                               
           20       13000                                                                                                                                                                               
          110       12000                                                                                                                                                                               
           50        5800                                                                                                                                                                               
           80       11000                                                                                                                                                                               
           60        9000                                                                                                                                                                               
           10        4400                                                                                                                                                                               

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(SALARY)"              // THIS IS IMPORTANT!!!!
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Neena                 90      17000       24000                                                                                                                                                         
Lex                   90      17000       24000                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Bruce                 60       6000        9000                                                                                                                                                         
Diana                 60       4200        9000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Trenna                50       3500        5800                                                                                                                                                         
Curtis                50       3100        5800                                                                                                                                                         
Randall               50       2600        5800                                                                                                                                                         
Peter                 50       2500        5800                                                                                                                                                         
Eleni                 80      10500       11000                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Jonathon              80       8600       11000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Pat                   20       6000       13000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300       12000                                                                                                                                                         

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAXSAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) MAXSAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY     MAXSAL                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , max(salary) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Neena                 90      17000       24000                                                                                                                                                         
Lex                   90      17000       24000                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Bruce                 60       6000        9000                                                                                                                                                         
Diana                 60       4200        9000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Trenna                50       3500        5800                                                                                                                                                         
Curtis                50       3100        5800                                                                                                                                                         
Randall               50       2600        5800                                                                                                                                                         
Peter                 50       2500        5800                                                                                                                                                         
Eleni                 80      10500       11000                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Jonathon              80       8600       11000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Pat                   20       6000       13000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300       12000                                                                                                                                                         

19 rows selected.

SQL> SELECT DEPARTMENT_ID , max(salary) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID MAX(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90       24000                                                                                                                                                                               
           20       13000                                                                                                                                                                               
          110       12000                                                                                                                                                                               
           50        5800                                                                                                                                                                               
           80       11000                                                                                                                                                                               
           60        9000                                                                                                                                                                               
           10        4400                                                                                                                                                                               

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "max(salary)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , max(salary) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "max(salary)"
                                             *
ERROR at line 1:
ORA-00904: "max(salary)": invalid identifier 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MaxSalary                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT * FROM (SELECT ROWNUM SRNO , D.* FROM DEPARTMENTS D) WHERE SRNO IN (3,7,8);   // OP USE BOLTE !!!!!!!!!!! LOGIC OR WOTTT !!!!!!!

      SRNO DEPARTMENT_ID DEPARTMENT_NAME                MANAGER_ID LOCATION_ID                                                                                                                          
---------- ------------- ------------------------------ ---------- -----------                                                                                                                          
         3            50 Shiping                               124        1500                                                                                                                          
         7           110 Accounting                            205        1700                                                                                                                          
         8           190 Contracting                                      1700                                                                                                                          

SQL> SELECT * FROM (SELECT ROWNUM SRNO , D.* FROM DEPARTMENTS D) WHERE MOD(SRNO,2)=0;

      SRNO DEPARTMENT_ID DEPARTMENT_NAME                MANAGER_ID LOCATION_ID                                                                                                                          
---------- ------------- ------------------------------ ---------- -----------                                                                                                                          
         2            20 Marketing                             201        1800                                                                                                                          
         4            60 IT                                    103        1400                                                                                                                          
         6            90 Executive                             100        1700                                                                                                                          
         8           190 Contracting                                      1700                                                                                                                          

SQL> SELECT * FROM (SELECT ROWNUM SRNO , D.* FROM DEPARTMENTS D) WHERE MOD(SRNO,2)=1;

      SRNO DEPARTMENT_ID DEPARTMENT_NAME                MANAGER_ID LOCATION_ID                                                                                                                          
---------- ------------- ------------------------------ ---------- -----------                                                                                                                          
         1            10 Administration                        200        1700                                                                                                                          
         3            50 Shiping                               124        1500                                                                                                                          
         5            80 Sales                                 149        2500                                                                                                                          
         7           110 Accounting                            205        1700                                                                                                                          

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MaxSalary                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES
  3  JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID) USING (DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MaxSalary                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES T2 GROUP BY DEPARTMENT_ID) ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID;
JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES T2 GROUP BY DEPARTMENT_ID) ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID
                                                                                                                     *
ERROR at line 3:
ORA-00904: "T2"."DEPARTMENT_ID": invalid identifier 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID) T2 ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
                    *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> SELECT FIRST_NAME , T1.DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT DEPARTMENT_ID , max(salary) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID) T2 ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID;

FIRST_NAME DEPARTMENT_ID     SALARY  MaxSalary                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> REM LAST_NAME , JOB_ID , SALARY , LOWEST SALARY PAID FOR JOB
SQL> 
SQL> REM 1 NATURAL 2 INNER JOIN USING 3 INNER JOIN ON
SQL> 
SQL> SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME  JOB_ID         SALARY MIN(SALARY)                                                                                                                                                            
---------- ---------- ---------- -----------                                                                                                                                                            
King       AD_PRES         24000       24000                                                                                                                                                            
Kochhar    AD_VP           17000       17000                                                                                                                                                            
De Haan    AD_VP           17000       17000                                                                                                                                                            
Hunold     IT_PROG          9000        4200                                                                                                                                                            
Ernst      IT_PROG          6000        4200                                                                                                                                                            
Lorentz    IT_PROG          4200        4200                                                                                                                                                            
Mourgos    ST_MAN           5800        5800                                                                                                                                                            
Rajs       ST_CLERK         3500        2500                                                                                                                                                            
Davies     ST_CLERK         3100        2500                                                                                                                                                            
Matos      ST_CLERK         2600        2500                                                                                                                                                            
Vargas     ST_CLERK         2500        2500                                                                                                                                                            
Zlotkey    SA_MAN          10500       10500                                                                                                                                                            
Abel       SA_REP          11000        7000                                                                                                                                                            
Taylor     SA_REP           8600        7000                                                                                                                                                            
Grant      SA_REP           7000        7000                                                                                                                                                            
Whalen     AD_ASST          4400        4400                                                                                                                                                            
Hartstein  MK_MAN          13000       13000                                                                                                                                                            
Fay        MK_REP           6000        6000                                                                                                                                                            
Higgins    AC_MGR          12000       12000                                                                                                                                                            
Gietz      AC_ACCOUNT       8300        8300                                                                                                                                                            

20 rows selected.

SQL> SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES
  3  JOIN (SELECT JOB_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID) USING (JOB_ID);    // INNER JOIN O WOTTT!!!!!

LAST_NAME  JOB_ID         SALARY MIN(SALARY)                                                                                                                                                            
---------- ---------- ---------- -----------                                                                                                                                                            
King       AD_PRES         24000       24000                                                                                                                                                            
Kochhar    AD_VP           17000       17000                                                                                                                                                            
De Haan    AD_VP           17000       17000                                                                                                                                                            
Hunold     IT_PROG          9000        4200                                                                                                                                                            
Ernst      IT_PROG          6000        4200                                                                                                                                                            
Lorentz    IT_PROG          4200        4200                                                                                                                                                            
Mourgos    ST_MAN           5800        5800                                                                                                                                                            
Rajs       ST_CLERK         3500        2500                                                                                                                                                            
Davies     ST_CLERK         3100        2500                                                                                                                                                            
Matos      ST_CLERK         2600        2500                                                                                                                                                            
Vargas     ST_CLERK         2500        2500                                                                                                                                                            
Zlotkey    SA_MAN          10500       10500                                                                                                                                                            
Abel       SA_REP          11000        7000                                                                                                                                                            
Taylor     SA_REP           8600        7000                                                                                                                                                            
Grant      SA_REP           7000        7000                                                                                                                                                            
Whalen     AD_ASST          4400        4400                                                                                                                                                            
Hartstein  MK_MAN          13000       13000                                                                                                                                                            
Fay        MK_REP           6000        6000                                                                                                                                                            
Higgins    AC_MGR          12000       12000                                                                                                                                                            
Gietz      AC_ACCOUNT       8300        8300                                                                                                                                                            

20 rows selected.

SQL> SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT JOB_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID) T2 ON T1.JOB_ID = T2.JOB_ID;
SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)"
                   *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> SELECT LAST_NAME , T1.JOB_ID , SALARY , "MIN(SALARY)"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT JOB_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID) T2 ON T1.JOB_ID = T2.JOB_ID;

LAST_NAME  JOB_ID         SALARY MIN(SALARY)                                                                                                                                                            
---------- ---------- ---------- -----------                                                                                                                                                            
King       AD_PRES         24000       24000                                                                                                                                                            
Kochhar    AD_VP           17000       17000                                                                                                                                                            
De Haan    AD_VP           17000       17000                                                                                                                                                            
Hunold     IT_PROG          9000        4200                                                                                                                                                            
Ernst      IT_PROG          6000        4200                                                                                                                                                            
Lorentz    IT_PROG          4200        4200                                                                                                                                                            
Mourgos    ST_MAN           5800        5800                                                                                                                                                            
Rajs       ST_CLERK         3500        2500                                                                                                                                                            
Davies     ST_CLERK         3100        2500                                                                                                                                                            
Matos      ST_CLERK         2600        2500                                                                                                                                                            
Vargas     ST_CLERK         2500        2500                                                                                                                                                            
Zlotkey    SA_MAN          10500       10500                                                                                                                                                            
Abel       SA_REP          11000        7000                                                                                                                                                            
Taylor     SA_REP           8600        7000                                                                                                                                                            
Grant      SA_REP           7000        7000                                                                                                                                                            
Whalen     AD_ASST          4400        4400                                                                                                                                                            
Hartstein  MK_MAN          13000       13000                                                                                                                                                            
Fay        MK_REP           6000        6000                                                                                                                                                            
Higgins    AC_MGR          12000       12000                                                                                                                                                            
Gietz      AC_ACCOUNT       8300        8300                                                                                                                                                            

20 rows selected.

SQL> SELECT LAST_NAME , JOB_ID , SALARY , MINSAL
  2  FROM EMPLOYEES T1
  3  
SQL> 
SQL> SELECT LAST_NAME , T1.JOB_ID , SALARY , MINSAL
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT JOB_ID , MIN(SALARY) MINSAL FROM EMPLOYEES GROUP BY JOB_ID) T2 ON T1.JOB_ID = T2.JOB_ID;     MINSAL NAME DIYA TOH UPAR PROJECTION MAI BHI MINSAL LIKHNA PADENGA!!!!

LAST_NAME  JOB_ID         SALARY     MINSAL                                                                                                                                                             
---------- ---------- ---------- ----------                                                                                                                                                             
King       AD_PRES         24000      24000                                                                                                                                                             
Kochhar    AD_VP           17000      17000                                                                                                                                                             
De Haan    AD_VP           17000      17000                                                                                                                                                             
Hunold     IT_PROG          9000       4200                                                                                                                                                             
Ernst      IT_PROG          6000       4200                                                                                                                                                             
Lorentz    IT_PROG          4200       4200                                                                                                                                                             
Mourgos    ST_MAN           5800       5800                                                                                                                                                             
Rajs       ST_CLERK         3500       2500                                                                                                                                                             
Davies     ST_CLERK         3100       2500                                                                                                                                                             
Matos      ST_CLERK         2600       2500                                                                                                                                                             
Vargas     ST_CLERK         2500       2500                                                                                                                                                             
Zlotkey    SA_MAN          10500      10500                                                                                                                                                             
Abel       SA_REP          11000       7000                                                                                                                                                             
Taylor     SA_REP           8600       7000                                                                                                                                                             
Grant      SA_REP           7000       7000                                                                                                                                                             
Whalen     AD_ASST          4400       4400                                                                                                                                                             
Hartstein  MK_MAN          13000      13000                                                                                                                                                             
Fay        MK_REP           6000       6000                                                                                                                                                             
Higgins    AC_MGR          12000      12000                                                                                                                                                             
Gietz      AC_ACCOUNT       8300       8300                                                                                                                                                             

20 rows selected.

SQL> SELECT LAST_NAME , T1.JOB_ID , SALARY , "Minimum Salary"
  2  FROM EMPLOYEES T1
  3  JOIN (SELECT JOB_ID , MIN(SALARY) "Minimum Salary" FROM EMPLOYEES GROUP BY JOB_ID) T2 ON T1.JOB_ID = T2.JOB_ID;

LAST_NAME  JOB_ID         SALARY Minimum Salary                                                                                                                                                         
---------- ---------- ---------- --------------                                                                                                                                                         
King       AD_PRES         24000          24000                                                                                                                                                         
Kochhar    AD_VP           17000          17000                                                                                                                                                         
De Haan    AD_VP           17000          17000                                                                                                                                                         
Hunold     IT_PROG          9000           4200                                                                                                                                                         
Ernst      IT_PROG          6000           4200                                                                                                                                                         
Lorentz    IT_PROG          4200           4200                                                                                                                                                         
Mourgos    ST_MAN           5800           5800                                                                                                                                                         
Rajs       ST_CLERK         3500           2500                                                                                                                                                         
Davies     ST_CLERK         3100           2500                                                                                                                                                         
Matos      ST_CLERK         2600           2500                                                                                                                                                         
Vargas     ST_CLERK         2500           2500                                                                                                                                                         
Zlotkey    SA_MAN          10500          10500                                                                                                                                                         
Abel       SA_REP          11000           7000                                                                                                                                                         
Taylor     SA_REP           8600           7000                                                                                                                                                         
Grant      SA_REP           7000           7000                                                                                                                                                         
Whalen     AD_ASST          4400           4400                                                                                                                                                         
Hartstein  MK_MAN          13000          13000                                                                                                                                                         
Fay        MK_REP           6000           6000                                                                                                                                                         
Higgins    AC_MGR          12000          12000                                                                                                                                                         
Gietz      AC_ACCOUNT       8300           8300                                                                                                                                                         

20 rows selected.

SQL> REM FIRST_NAME , SALARY , DEPARTMENT WISE LOWEST SALARY , JOB_ID , JOB WISE HIGHEST SALARY
SQL> 
SQL> SELECT FIRST_NAME,SALARY,"MIN(SALARY)",JOB_ID,"MAX(SALARY)" FROM EMPLOYEES NATURAL JOIN (SELECT DEPARTMENT_ID,MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID) NATURAL JOIN (SELECT JOB_ID,MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

SQL> USING INNER JOIN // VIRAL MODI
 
SQL> SELECT FIRST_NAME,SALARY,T1.DEPARTMENT_ID,DEPTMINSAL,T1.JOB_ID,JOBMAXSAL FROM EMPLOYEES T1           // JUST STAY CALM AND WRITE..
     JOIN (SELECT JOB_ID,MAX(SALARY) JOBMAXSAL FROM EMPLOYEES GROUP BY JOB_ID) T2 ON T1.JOB_ID=T2.JOB_ID
     JOIN (SELECT DEPARTMENT_ID,MIN(SALARY) DEPTMINSAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID) T3 ON T1.DEPARTMENT_ID=T3.DEPARTMENT_ID;

FIRST_NAME     SALARY MIN(SALARY) JOB_ID     MAX(SALARY)                                                                                                                                                
---------- ---------- ----------- ---------- -----------                                                                                                                                                
Alexander        9000        4200 IT_PROG           9000                                                                                                                                                
Bruce            6000        4200 IT_PROG           9000                                                                                                                                                
Diana            4200        4200 IT_PROG           9000                                                                                                                                                
Shelley         12000        8300 AC_MGR           12000                                                                                                                                                
William          8300        8300 AC_ACCOUNT        8300                                                                                                                                                
Kevin            5800        2500 ST_MAN            5800                                                                                                                                                
Jennifer         4400        4400 AD_ASST           4400                                                                                                                                                
Neena           17000       17000 AD_VP            17000                                                                                                                                                
Lex             17000       17000 AD_VP            17000                                                                                                                                                
Eleni           10500        8600 SA_MAN           10500                                                                                                                                                
Michael         13000        6000 MK_MAN           13000                                                                                                                                                
Steven          24000       17000 AD_PRES          24000                                                                                                                                                
Ellen           11000        8600 SA_REP           11000                                                                                                                                                
Jonathon         8600        8600 SA_REP           11000                                                                                                                                                
Pat              6000        6000 MK_REP            6000                                                                                                                                                
Trenna           3500        2500 ST_CLERK          3500                                                                                                                                                
Curtis           3100        2500 ST_CLERK          3500                                                                                                                                                
Randall          2600        2500 ST_CLERK          3500                                                                                                                                                
Peter            2500        2500 ST_CLERK          3500                                                                                                                                                

19 rows selected.

SQL> SELECT FIRST_NAME, SALARY, DEPARTMENT_ID, "MIN(SALARY)" , JOB_ID , "MAX(SALARY)" FROM EMPLOYEES NATURAL JOIN (SELECT DEPARTMENT_ID , MIN(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID) NATURAL JOIN (SELECT JOB_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME     SALARY DEPARTMENT_ID MIN(SALARY) JOB_ID     MAX(SALARY)                                                                                                                                  
---------- ---------- ------------- ----------- ---------- -----------                                                                                                                                  
Alexander        9000            60        4200 IT_PROG           9000                                                                                                                                  
Bruce            6000            60        4200 IT_PROG           9000                                                                                                                                  
Diana            4200            60        4200 IT_PROG           9000                                                                                                                                  
Shelley         12000           110        8300 AC_MGR           12000                                                                                                                                  
William          8300           110        8300 AC_ACCOUNT        8300                                                                                                                                  
Kevin            5800            50        2500 ST_MAN            5800                                                                                                                                  
Jennifer         4400            10        4400 AD_ASST           4400                                                                                                                                  
Neena           17000            90       17000 AD_VP            17000                                                                                                                                  
Lex             17000            90       17000 AD_VP            17000                                                                                                                                  
Eleni           10500            80        8600 SA_MAN           10500                                                                                                                                  
Michael         13000            20        6000 MK_MAN           13000                                                                                                                                  
Steven          24000            90       17000 AD_PRES          24000                                                                                                                                  
Ellen           11000            80        8600 SA_REP           11000                                                                                                                                  
Jonathon         8600            80        8600 SA_REP           11000                                                                                                                                  
Pat              6000            20        6000 MK_REP            6000                                                                                                                                  
Trenna           3500            50        2500 ST_CLERK          3500                                                                                                                                  
Curtis           3100            50        2500 ST_CLERK          3500                                                                                                                                  
Randall          2600            50        2500 ST_CLERK          3500                                                                                                                                  
Peter            2500            50        2500 ST_CLERK          3500                                                                                                                                  

19 rows selected.

SQL> SELECT FIRST_NAME,SALARY,DLOWSAL,JOB_ID,JHIGHSAL FROM EMPLOYEES NATURAL JOIN (SELECT DEPARTMENT_ID,MIN(SALARY) DLOWSAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID) NATURAL JOIN (SELECT JOB_ID,MAX(SALARY) JHIGHSAL FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME     SALARY    DLOWSAL JOB_ID       JHIGHSAL                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
Alexander        9000       4200 IT_PROG          9000                                                                                                                                                  
Bruce            6000       4200 IT_PROG          9000                                                                                                                                                  
Diana            4200       4200 IT_PROG          9000                                                                                                                                                  
Shelley         12000       8300 AC_MGR          12000                                                                                                                                                  
William          8300       8300 AC_ACCOUNT       8300                                                                                                                                                  
Kevin            5800       2500 ST_MAN           5800                                                                                                                                                  
Jennifer         4400       4400 AD_ASST          4400                                                                                                                                                  
Neena           17000      17000 AD_VP           17000                                                                                                                                                  
Lex             17000      17000 AD_VP           17000                                                                                                                                                  
Eleni           10500       8600 SA_MAN          10500                                                                                                                                                  
Michael         13000       6000 MK_MAN          13000                                                                                                                                                  
Steven          24000      17000 AD_PRES         24000                                                                                                                                                  
Ellen           11000       8600 SA_REP          11000                                                                                                                                                  
Jonathon         8600       8600 SA_REP          11000                                                                                                                                                  
Pat              6000       6000 MK_REP           6000                                                                                                                                                  
Trenna           3500       2500 ST_CLERK         3500                                                                                                                                                  
Curtis           3100       2500 ST_CLERK         3500                                                                                                                                                  
Randall          2600       2500 ST_CLERK         3500                                                                                                                                                  
Peter            2500       2500 ST_CLERK         3500                                                                                                                                                  

19 rows selected.

SQL> SELECT FIRST_NAME,SALARY,DPT_MIN_SAL,JOB_MAX_SAL           // OP!!!!! SYSTEMATIC MANNER OF WRITING!!!!!!!
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID,MIN(SALARY)  DPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  NATURAL JOIN (SELECT JOB_ID,MAX(SALARY)  JOB_MAX_SAL FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME     SALARY DPT_MIN_SAL JOB_MAX_SAL                                                                                                                                                           
---------- ---------- ----------- -----------                                                                                                                                                           
Alexander        9000        4200        9000                                                                                                                                                           
Bruce            6000        4200        9000                                                                                                                                                           
Diana            4200        4200        9000                                                                                                                                                           
Shelley         12000        8300       12000                                                                                                                                                           
William          8300        8300        8300                                                                                                                                                           
Kevin            5800        2500        5800                                                                                                                                                           
Jennifer         4400        4400        4400                                                                                                                                                           
Neena           17000       17000       17000                                                                                                                                                           
Lex             17000       17000       17000                                                                                                                                                           
Eleni           10500        8600       10500                                                                                                                                                           
Michael         13000        6000       13000                                                                                                                                                           
Steven          24000       17000       24000                                                                                                                                                           
Ellen           11000        8600       11000                                                                                                                                                           
Jonathon         8600        8600       11000                                                                                                                                                           
Pat              6000        6000        6000                                                                                                                                                           
Trenna           3500        2500        3500                                                                                                                                                           
Curtis           3100        2500        3500                                                                                                                                                           
Randall          2600        2500        3500                                                                                                                                                           
Peter            2500        2500        3500                                                                                                                                                           

19 rows selected.

SQL> SELECT FIRST_NAME,SALARY,DEPARTMENT_ID , DPT_MIN_SAL,JOB_ID , JOB_MAX_SAL
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID,MIN(SALARY)  DPT_MIN_SAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
  4  NATURAL JOIN (SELECT JOB_ID,MAX(SALARY)  JOB_MAX_SAL FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME     SALARY DEPARTMENT_ID DPT_MIN_SAL JOB_ID     JOB_MAX_SAL                                                                                                                                  
---------- ---------- ------------- ----------- ---------- -----------                                                                                                                                  
Alexander        9000            60        4200 IT_PROG           9000                                                                                                                                  
Bruce            6000            60        4200 IT_PROG           9000                                                                                                                                  
Diana            4200            60        4200 IT_PROG           9000                                                                                                                                  
Shelley         12000           110        8300 AC_MGR           12000                                                                                                                                  
William          8300           110        8300 AC_ACCOUNT        8300                                                                                                                                  
Kevin            5800            50        2500 ST_MAN            5800                                                                                                                                  
Jennifer         4400            10        4400 AD_ASST           4400                                                                                                                                  
Neena           17000            90       17000 AD_VP            17000                                                                                                                                  
Lex             17000            90       17000 AD_VP            17000                                                                                                                                  
Eleni           10500            80        8600 SA_MAN           10500                                                                                                                                  
Michael         13000            20        6000 MK_MAN           13000                                                                                                                                  
Steven          24000            90       17000 AD_PRES          24000                                                                                                                                  
Ellen           11000            80        8600 SA_REP           11000                                                                                                                                  
Jonathon         8600            80        8600 SA_REP           11000                                                                                                                                  
Pat              6000            20        6000 MK_REP            6000                                                                                                                                  
Trenna           3500            50        2500 ST_CLERK          3500                                                                                                                                  
Curtis           3100            50        2500 ST_CLERK          3500                                                                                                                                  
Randall          2600            50        2500 ST_CLERK          3500                                                                                                                                  
Peter            2500            50        2500 ST_CLERK          3500                                                                                                                                  

19 rows selected.

SQL> REM LAST_NAME , DEPARTMENT_ID , SALARY , TOTAL SALARY PAID TO DEPARMENT , % OF TOTAL SALARY
SQL> 
SQL> REM % : SALARY * 100 / TOTAL SALARY
SQL> 
SQL> SELECT LAST_NAME , DEPARTMENT_ID , SALARY , "SUM(SALARY)" , (SALARY * 100)/"SUM(SALARY)" FROM EMPLOYEES NATURAL JOIN (SELECT DEPARTMENT_ID,SUM(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

SQL>SELECT FIRST_NAME,DEPARTMENT_ID,SALARY,DEPTSUMSAL,SALARY*100/DEPTSUMSAL FROM EMPLOYEES             // EASY O WOTTTTT!!!!!!
    NATURAL JOIN (SELECT DEPARTMENT_ID,SUM(SALARY) DEPTSUMSAL FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

LAST_NAME  DEPARTMENT_ID     SALARY SUM(SALARY) (SALARY*100)/"SUM(SALARY)"                                                                                                                              
---------- ------------- ---------- ----------- --------------------------                                                                                                                              
King                  90      24000       58000                 41.3793103                                                                                                                              
Kochhar               90      17000       58000                 29.3103448                                                                                                                              
De Haan               90      17000       58000                 29.3103448                                                                                                                              
Hunold                60       9000       19200                     46.875                                                                                                                              
Ernst                 60       6000       19200                      31.25                                                                                                                              
Lorentz               60       4200       19200                     21.875                                                                                                                              
Mourgos               50       5800       17500                 33.1428571                                                                                                                              
Rajs                  50       3500       17500                         20                                                                                                                              
Davies                50       3100       17500                 17.7142857                                                                                                                              
Matos                 50       2600       17500                 14.8571429                                                                                                                              
Vargas                50       2500       17500                 14.2857143                                                                                                                              
Zlotkey               80      10500       30100                 34.8837209                                                                                                                              
Abel                  80      11000       30100                 36.5448505                                                                                                                              
Taylor                80       8600       30100                 28.5714286                                                                                                                              
Whalen                10       4400        4400                        100                                                                                                                              
Hartstein             20      13000       19000                 68.4210526                                                                                                                              
Fay                   20       6000       19000                 31.5789474                                                                                                                              
Higgins              110      12000       20300                 59.1133005                                                                                                                              
Gietz                110       8300       20300                 40.8866995                                                                                                                              

19 rows selected.

SQL> REM LAST_NAME , JOB_ID , SALARY , HIGHEST SALARY PAID TO JOB , DIFFERENCE        // CAN BE DONE EASILY NOW!!!!!!!!!!
SQL> 
SQL> SELECT LAST_NAME,JOB_ID,SALARY,MAXSAL,MAXSAL-SALARY FROM EMPLOYEES NATURAL JOIN (SELECT JOB_ID,MAX(SALARY) MAXSAL FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME  JOB_ID         SALARY     MAXSAL MAXSAL-SALARY                                                                                                                                               
---------- ---------- ---------- ---------- -------------                                                                                                                                               
King       AD_PRES         24000      24000             0                                                                                                                                               
Kochhar    AD_VP           17000      17000             0                                                                                                                                               
De Haan    AD_VP           17000      17000             0                                                                                                                                               
Hunold     IT_PROG          9000       9000             0                                                                                                                                               
Ernst      IT_PROG          6000       9000          3000                                                                                                                                               
Lorentz    IT_PROG          4200       9000          4800                                                                                                                                               
Mourgos    ST_MAN           5800       5800             0                                                                                                                                               
Rajs       ST_CLERK         3500       3500             0                                                                                                                                               
Davies     ST_CLERK         3100       3500           400                                                                                                                                               
Matos      ST_CLERK         2600       3500           900                                                                                                                                               
Vargas     ST_CLERK         2500       3500          1000                                                                                                                                               
Zlotkey    SA_MAN          10500      10500             0                                                                                                                                               
Abel       SA_REP          11000      11000             0                                                                                                                                               
Taylor     SA_REP           8600      11000          2400                                                                                                                                               
Grant      SA_REP           7000      11000          4000                                                                                                                                               
Whalen     AD_ASST          4400       4400             0                                                                                                                                               
Hartstein  MK_MAN          13000      13000             0                                                                                                                                               
Fay        MK_REP           6000       6000             0                                                                                                                                               
Higgins    AC_MGR          12000      12000             0                                                                                                                                               
Gietz      AC_ACCOUNT       8300       8300             0                                                                                                                                               

20 rows selected.

SQL> SELECT LAST_NAME,JOB_ID,SALARY,MAXSAL,MAXSAL-SALARY DIFFERENCE FROM EMPLOYEES NATURAL JOIN (SELECT JOB_ID,MAX(SALARY) MAXSAL FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME  JOB_ID         SALARY     MAXSAL DIFFERENCE                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
King       AD_PRES         24000      24000          0                                                                                                                                                  
Kochhar    AD_VP           17000      17000          0                                                                                                                                                  
De Haan    AD_VP           17000      17000          0                                                                                                                                                  
Hunold     IT_PROG          9000       9000          0                                                                                                                                                  
Ernst      IT_PROG          6000       9000       3000                                                                                                                                                  
Lorentz    IT_PROG          4200       9000       4800                                                                                                                                                  
Mourgos    ST_MAN           5800       5800          0                                                                                                                                                  
Rajs       ST_CLERK         3500       3500          0                                                                                                                                                  
Davies     ST_CLERK         3100       3500        400                                                                                                                                                  
Matos      ST_CLERK         2600       3500        900                                                                                                                                                  
Vargas     ST_CLERK         2500       3500       1000                                                                                                                                                  
Zlotkey    SA_MAN          10500      10500          0                                                                                                                                                  
Abel       SA_REP          11000      11000          0                                                                                                                                                  
Taylor     SA_REP           8600      11000       2400                                                                                                                                                  
Grant      SA_REP           7000      11000       4000                                                                                                                                                  
Whalen     AD_ASST          4400       4400          0                                                                                                                                                  
Hartstein  MK_MAN          13000      13000          0                                                                                                                                                  
Fay        MK_REP           6000       6000          0                                                                                                                                                  
Higgins    AC_MGR          12000      12000          0                                                                                                                                                  
Gietz      AC_ACCOUNT       8300       8300          0                                                                                                                                                  

20 rows selected.

SQL> SPOOL OFF
